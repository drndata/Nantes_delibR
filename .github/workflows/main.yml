name: Deploy to shinyapps.io
on:

  # run on any push 
  push:

  # run on request (via button in actions menu)
  workflow_dispatch:
      
jobs:
  deploy:
    name: Deploy to shinyapps
    
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
        name: Deploy to shinyapps.io
        env:
          SHINY_USERNAME: 'bacasable'
          SHINY_TOKEN: ${{ secrets.SHINYAPP_TOKEN }}
          SHINY_SECRET: ${{ secrets.SHINYAPP_SECRET }}
          APP_NAME: 'Nantes_delibR'
          APP_DIR: ''
      - name: Deploy
        run: |
          rsconnect::setAccountInfo(name='bacasable', token='${{ env.SHINYAPPS_TOKEN }}', secret='${{ secrets.SHINYAPPS_SECRET }}')
          rsconnect::deployApp()
